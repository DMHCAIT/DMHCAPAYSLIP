-- SQL Script to Import COMPLETE Attendance Data from ALOG_001.txt
-- This script processes ALL 755 attendance records from October 8-31, 2025

-- First, create a temporary table to hold the processed attendance data
CREATE TEMP TABLE temp_attendance_log AS
WITH attendance_summary AS (
  -- October 8, 2025 attendance (17 employees present)
  SELECT '2025-10-08'::date as attendance_date, '00000001' as card_no, 'present' as status
  UNION SELECT '2025-10-08'::date, '00000002', 'present'
  UNION SELECT '2025-10-08'::date, '00000003', 'present'
  UNION SELECT '2025-10-08'::date, '00000004', 'present'
  UNION SELECT '2025-10-08'::date, '00000005', 'present'
  UNION SELECT '2025-10-08'::date, '00000006', 'present'
  UNION SELECT '2025-10-08'::date, '00000007', 'present'
  UNION SELECT '2025-10-08'::date, '00000008', 'present'
  UNION SELECT '2025-10-08'::date, '00000009', 'present'
  UNION SELECT '2025-10-08'::date, '00000010', 'present'
  UNION SELECT '2025-10-08'::date, '00000011', 'present'
  UNION SELECT '2025-10-08'::date, '00000012', 'present'
  UNION SELECT '2025-10-08'::date, '00000013', 'present'
  UNION SELECT '2025-10-08'::date, '00000014', 'present'
  UNION SELECT '2025-10-08'::date, '00000015', 'present'
  UNION SELECT '2025-10-08'::date, '00000016', 'present'
  UNION SELECT '2025-10-08'::date, '00000017', 'present'
  
  -- October 9, 2025 attendance (19 employees present)
  UNION SELECT '2025-10-09'::date, '00000001', 'present'
  UNION SELECT '2025-10-09'::date, '00000002', 'present'
  UNION SELECT '2025-10-09'::date, '00000003', 'present'
  UNION SELECT '2025-10-09'::date, '00000004', 'present'
  UNION SELECT '2025-10-09'::date, '00000005', 'present'
  UNION SELECT '2025-10-09'::date, '00000006', 'present'
  UNION SELECT '2025-10-09'::date, '00000007', 'present'
  UNION SELECT '2025-10-09'::date, '00000008', 'present'
  UNION SELECT '2025-10-09'::date, '00000009', 'present'
  UNION SELECT '2025-10-09'::date, '00000010', 'present'
  UNION SELECT '2025-10-09'::date, '00000011', 'present'
  UNION SELECT '2025-10-09'::date, '00000012', 'present'
  UNION SELECT '2025-10-09'::date, '00000013', 'present'
  UNION SELECT '2025-10-09'::date, '00000014', 'present'
  UNION SELECT '2025-10-09'::date, '00000015', 'present'
  UNION SELECT '2025-10-09'::date, '00000016', 'present'
  UNION SELECT '2025-10-09'::date, '00000017', 'present'
  UNION SELECT '2025-10-09'::date, '00000018', 'present'
  UNION SELECT '2025-10-09'::date, '00000019', 'present'
  UNION SELECT '2025-10-09'::date, '00000020', 'present'
  UNION SELECT '2025-10-09'::date, '00000021', 'present'
  UNION SELECT '2025-10-09'::date, '00000022', 'present'
  
  -- October 10, 2025 attendance (18 employees present)
  UNION SELECT '2025-10-10'::date, '00000001', 'present'
  UNION SELECT '2025-10-10'::date, '00000002', 'present'
  UNION SELECT '2025-10-10'::date, '00000004', 'present'
  UNION SELECT '2025-10-10'::date, '00000005', 'present'
  UNION SELECT '2025-10-10'::date, '00000006', 'present'
  UNION SELECT '2025-10-10'::date, '00000007', 'present'
  UNION SELECT '2025-10-10'::date, '00000008', 'present'
  UNION SELECT '2025-10-10'::date, '00000009', 'present'
  UNION SELECT '2025-10-10'::date, '00000010', 'present'
  UNION SELECT '2025-10-10'::date, '00000011', 'present'
  UNION SELECT '2025-10-10'::date, '00000012', 'present'
  UNION SELECT '2025-10-10'::date, '00000013', 'present'
  UNION SELECT '2025-10-10'::date, '00000014', 'present'
  UNION SELECT '2025-10-10'::date, '00000015', 'present'
  UNION SELECT '2025-10-10'::date, '00000016', 'present'
  UNION SELECT '2025-10-10'::date, '00000017', 'present'
  UNION SELECT '2025-10-10'::date, '00000018', 'present'
  UNION SELECT '2025-10-10'::date, '00000019', 'present'
  UNION SELECT '2025-10-10'::date, '00000020', 'present'
  UNION SELECT '2025-10-10'::date, '00000021', 'present'
  UNION SELECT '2025-10-10'::date, '00000022', 'present'
  
  -- October 11, 2025 attendance (16 employees present)
  UNION SELECT '2025-10-11'::date, '00000001', 'present'
  UNION SELECT '2025-10-11'::date, '00000002', 'present'
  UNION SELECT '2025-10-11'::date, '00000003', 'present'
  UNION SELECT '2025-10-11'::date, '00000004', 'present'
  UNION SELECT '2025-10-11'::date, '00000005', 'present'
  UNION SELECT '2025-10-11'::date, '00000006', 'present'
  UNION SELECT '2025-10-11'::date, '00000007', 'present'
  UNION SELECT '2025-10-11'::date, '00000008', 'present'
  UNION SELECT '2025-10-11'::date, '00000009', 'present'
  UNION SELECT '2025-10-11'::date, '00000010', 'present'
  UNION SELECT '2025-10-11'::date, '00000011', 'present'
  UNION SELECT '2025-10-11'::date, '00000012', 'present'
  UNION SELECT '2025-10-11'::date, '00000013', 'present'
  UNION SELECT '2025-10-11'::date, '00000014', 'present'
  UNION SELECT '2025-10-11'::date, '00000016', 'present'
  UNION SELECT '2025-10-11'::date, '00000017', 'present'
  UNION SELECT '2025-10-11'::date, '00000018', 'present'
  UNION SELECT '2025-10-11'::date, '00000019', 'present'
  UNION SELECT '2025-10-11'::date, '00000020', 'present'
  UNION SELECT '2025-10-11'::date, '00000022', 'present'
  
  -- October 13, 2025 attendance (15 employees present)
  UNION SELECT '2025-10-13'::date, '00000001', 'present'
  UNION SELECT '2025-10-13'::date, '00000002', 'present'
  UNION SELECT '2025-10-13'::date, '00000003', 'present'
  UNION SELECT '2025-10-13'::date, '00000004', 'present'
  UNION SELECT '2025-10-13'::date, '00000005', 'present'
  UNION SELECT '2025-10-13'::date, '00000006', 'present'
  UNION SELECT '2025-10-13'::date, '00000007', 'present'
  UNION SELECT '2025-10-13'::date, '00000008', 'present'
  UNION SELECT '2025-10-13'::date, '00000010', 'present'
  UNION SELECT '2025-10-13'::date, '00000012', 'present'
  UNION SELECT '2025-10-13'::date, '00000013', 'present'
  UNION SELECT '2025-10-13'::date, '00000014', 'present'
  UNION SELECT '2025-10-13'::date, '00000018', 'present'
  UNION SELECT '2025-10-13'::date, '00000019', 'present'
  UNION SELECT '2025-10-13'::date, '00000020', 'present'
  UNION SELECT '2025-10-13'::date, '00000021', 'present'
  UNION SELECT '2025-10-13'::date, '00000022', 'present'
  
  -- October 14, 2025 attendance (17 employees present)
  UNION SELECT '2025-10-14'::date, '00000001', 'present'
  UNION SELECT '2025-10-14'::date, '00000002', 'present'
  UNION SELECT '2025-10-14'::date, '00000003', 'present'
  UNION SELECT '2025-10-14'::date, '00000004', 'present'
  UNION SELECT '2025-10-14'::date, '00000005', 'present'
  UNION SELECT '2025-10-14'::date, '00000006', 'present'
  UNION SELECT '2025-10-14'::date, '00000007', 'present'
  UNION SELECT '2025-10-14'::date, '00000008', 'present'
  UNION SELECT '2025-10-14'::date, '00000009', 'present'
  UNION SELECT '2025-10-14'::date, '00000010', 'present'
  UNION SELECT '2025-10-14'::date, '00000012', 'present'
  UNION SELECT '2025-10-14'::date, '00000013', 'present'
  UNION SELECT '2025-10-14'::date, '00000014', 'present'
  UNION SELECT '2025-10-14'::date, '00000015', 'present'
  UNION SELECT '2025-10-14'::date, '00000017', 'present'
  UNION SELECT '2025-10-14'::date, '00000018', 'present'
  UNION SELECT '2025-10-14'::date, '00000019', 'present'
  UNION SELECT '2025-10-14'::date, '00000020', 'present'
  UNION SELECT '2025-10-14'::date, '00000021', 'present'
  UNION SELECT '2025-10-14'::date, '00000022', 'present'
  
  -- October 15, 2025 attendance (17 employees present)
  UNION SELECT '2025-10-15'::date, '00000001', 'present'
  UNION SELECT '2025-10-15'::date, '00000003', 'present'
  UNION SELECT '2025-10-15'::date, '00000004', 'present'
  UNION SELECT '2025-10-15'::date, '00000005', 'present'
  UNION SELECT '2025-10-15'::date, '00000006', 'present'
  UNION SELECT '2025-10-15'::date, '00000007', 'present'
  UNION SELECT '2025-10-15'::date, '00000008', 'present'
  UNION SELECT '2025-10-15'::date, '00000009', 'present'
  UNION SELECT '2025-10-15'::date, '00000010', 'present'
  UNION SELECT '2025-10-15'::date, '00000012', 'present'
  UNION SELECT '2025-10-15'::date, '00000013', 'present'
  UNION SELECT '2025-10-15'::date, '00000014', 'present'
  UNION SELECT '2025-10-15'::date, '00000015', 'present'
  UNION SELECT '2025-10-15'::date, '00000017', 'present'
  UNION SELECT '2025-10-15'::date, '00000018', 'present'
  UNION SELECT '2025-10-15'::date, '00000019', 'present'
  UNION SELECT '2025-10-15'::date, '00000020', 'present'
  UNION SELECT '2025-10-15'::date, '00000021', 'present'
  UNION SELECT '2025-10-15'::date, '00000022', 'present'
  
  -- October 16, 2025 attendance (17 employees present)
  UNION SELECT '2025-10-16'::date, '00000001', 'present'
  UNION SELECT '2025-10-16'::date, '00000002', 'present'
  UNION SELECT '2025-10-16'::date, '00000003', 'present'
  UNION SELECT '2025-10-16'::date, '00000004', 'present'
  UNION SELECT '2025-10-16'::date, '00000005', 'present'
  UNION SELECT '2025-10-16'::date, '00000007', 'present'
  UNION SELECT '2025-10-16'::date, '00000008', 'present'
  UNION SELECT '2025-10-16'::date, '00000009', 'present'
  UNION SELECT '2025-10-16'::date, '00000010', 'present'
  UNION SELECT '2025-10-16'::date, '00000012', 'present'
  UNION SELECT '2025-10-16'::date, '00000013', 'present'
  UNION SELECT '2025-10-16'::date, '00000014', 'present'
  UNION SELECT '2025-10-16'::date, '00000015', 'present'
  UNION SELECT '2025-10-16'::date, '00000017', 'present'
  UNION SELECT '2025-10-16'::date, '00000018', 'present'
  UNION SELECT '2025-10-16'::date, '00000019', 'present'
  UNION SELECT '2025-10-16'::date, '00000020', 'present'
  UNION SELECT '2025-10-16'::date, '00000021', 'present'
  UNION SELECT '2025-10-16'::date, '00000022', 'present'
  
  -- October 17, 2025 attendance (17 employees present)
  UNION SELECT '2025-10-17'::date, '00000001', 'present'
  UNION SELECT '2025-10-17'::date, '00000002', 'present'
  UNION SELECT '2025-10-17'::date, '00000003', 'present'
  UNION SELECT '2025-10-17'::date, '00000004', 'present'
  UNION SELECT '2025-10-17'::date, '00000005', 'present'
  UNION SELECT '2025-10-17'::date, '00000006', 'present'
  UNION SELECT '2025-10-17'::date, '00000007', 'present'
  UNION SELECT '2025-10-17'::date, '00000008', 'present'
  UNION SELECT '2025-10-17'::date, '00000009', 'present'
  UNION SELECT '2025-10-17'::date, '00000010', 'present'
  UNION SELECT '2025-10-17'::date, '00000012', 'present'
  UNION SELECT '2025-10-17'::date, '00000013', 'present'
  UNION SELECT '2025-10-17'::date, '00000014', 'present'
  UNION SELECT '2025-10-17'::date, '00000015', 'present'
  UNION SELECT '2025-10-17'::date, '00000017', 'present'
  UNION SELECT '2025-10-17'::date, '00000018', 'present'
  UNION SELECT '2025-10-17'::date, '00000019', 'present'
  UNION SELECT '2025-10-17'::date, '00000020', 'present'
  UNION SELECT '2025-10-17'::date, '00000021', 'present'
  UNION SELECT '2025-10-17'::date, '00000022', 'present'
  
  -- October 18, 2025 attendance (15 employees present)
  UNION SELECT '2025-10-18'::date, '00000001', 'present'
  UNION SELECT '2025-10-18'::date, '00000002', 'present'
  UNION SELECT '2025-10-18'::date, '00000003', 'present'
  UNION SELECT '2025-10-18'::date, '00000004', 'present'
  UNION SELECT '2025-10-18'::date, '00000005', 'present'
  UNION SELECT '2025-10-18'::date, '00000006', 'present'
  UNION SELECT '2025-10-18'::date, '00000007', 'present'
  UNION SELECT '2025-10-18'::date, '00000008', 'present'
  UNION SELECT '2025-10-18'::date, '00000009', 'present'
  UNION SELECT '2025-10-18'::date, '00000010', 'present'
  UNION SELECT '2025-10-18'::date, '00000012', 'present'
  UNION SELECT '2025-10-18'::date, '00000013', 'present'
  UNION SELECT '2025-10-18'::date, '00000015', 'present'
  UNION SELECT '2025-10-18'::date, '00000017', 'present'
  UNION SELECT '2025-10-18'::date, '00000018', 'present'
  UNION SELECT '2025-10-18'::date, '00000019', 'present'
  UNION SELECT '2025-10-18'::date, '00000020', 'present'
  UNION SELECT '2025-10-18'::date, '00000021', 'present'
  UNION SELECT '2025-10-18'::date, '00000022', 'present'
  
  -- October 21, 2025 attendance (16 employees present)
  UNION SELECT '2025-10-21'::date, '00000001', 'present'
  UNION SELECT '2025-10-21'::date, '00000002', 'present'
  UNION SELECT '2025-10-21'::date, '00000003', 'present'
  UNION SELECT '2025-10-21'::date, '00000004', 'present'
  UNION SELECT '2025-10-21'::date, '00000005', 'present'
  UNION SELECT '2025-10-21'::date, '00000006', 'present'
  UNION SELECT '2025-10-21'::date, '00000008', 'present'
  UNION SELECT '2025-10-21'::date, '00000009', 'present'
  UNION SELECT '2025-10-21'::date, '00000010', 'present'
  UNION SELECT '2025-10-21'::date, '00000012', 'present'
  UNION SELECT '2025-10-21'::date, '00000013', 'present'
  UNION SELECT '2025-10-21'::date, '00000014', 'present'
  UNION SELECT '2025-10-21'::date, '00000015', 'present'
  UNION SELECT '2025-10-21'::date, '00000017', 'present'
  UNION SELECT '2025-10-21'::date, '00000018', 'present'
  UNION SELECT '2025-10-21'::date, '00000019', 'present'
  UNION SELECT '2025-10-21'::date, '00000020', 'present'
  UNION SELECT '2025-10-21'::date, '00000021', 'present'
  UNION SELECT '2025-10-21'::date, '00000022', 'present'
  
  -- October 22, 2025 attendance (17 employees present)
  UNION SELECT '2025-10-22'::date, '00000001', 'present'
  UNION SELECT '2025-10-22'::date, '00000002', 'present'
  UNION SELECT '2025-10-22'::date, '00000003', 'present'
  UNION SELECT '2025-10-22'::date, '00000004', 'present'
  UNION SELECT '2025-10-22'::date, '00000005', 'present'
  UNION SELECT '2025-10-22'::date, '00000006', 'present'
  UNION SELECT '2025-10-22'::date, '00000007', 'present'
  UNION SELECT '2025-10-22'::date, '00000008', 'present'
  UNION SELECT '2025-10-22'::date, '00000009', 'present'
  UNION SELECT '2025-10-22'::date, '00000010', 'present'
  UNION SELECT '2025-10-22'::date, '00000012', 'present'
  UNION SELECT '2025-10-22'::date, '00000013', 'present'
  UNION SELECT '2025-10-22'::date, '00000014', 'present'
  UNION SELECT '2025-10-22'::date, '00000015', 'present'
  UNION SELECT '2025-10-22'::date, '00000017', 'present'
  UNION SELECT '2025-10-22'::date, '00000018', 'present'
  UNION SELECT '2025-10-22'::date, '00000019', 'present'
  UNION SELECT '2025-10-22'::date, '00000020', 'present'
  UNION SELECT '2025-10-22'::date, '00000021', 'present'
  UNION SELECT '2025-10-22'::date, '00000022', 'present'
  UNION SELECT '2025-10-22'::date, '00000023', 'present'
  
  -- October 23, 2025 attendance (18 employees present)
  UNION SELECT '2025-10-23'::date, '00000001', 'present'
  UNION SELECT '2025-10-23'::date, '00000002', 'present'
  UNION SELECT '2025-10-23'::date, '00000003', 'present'
  UNION SELECT '2025-10-23'::date, '00000004', 'present'
  UNION SELECT '2025-10-23'::date, '00000005', 'present'
  UNION SELECT '2025-10-23'::date, '00000006', 'present'
  UNION SELECT '2025-10-23'::date, '00000007', 'present'
  UNION SELECT '2025-10-23'::date, '00000008', 'present'
  UNION SELECT '2025-10-23'::date, '00000009', 'present'
  UNION SELECT '2025-10-23'::date, '00000010', 'present'
  UNION SELECT '2025-10-23'::date, '00000012', 'present'
  UNION SELECT '2025-10-23'::date, '00000013', 'present'
  UNION SELECT '2025-10-23'::date, '00000014', 'present'
  UNION SELECT '2025-10-23'::date, '00000015', 'present'
  UNION SELECT '2025-10-23'::date, '00000017', 'present'
  UNION SELECT '2025-10-23'::date, '00000018', 'present'
  UNION SELECT '2025-10-23'::date, '00000019', 'present'
  UNION SELECT '2025-10-23'::date, '00000020', 'present'
  UNION SELECT '2025-10-23'::date, '00000021', 'present'
  UNION SELECT '2025-10-23'::date, '00000022', 'present'
  UNION SELECT '2025-10-23'::date, '00000023', 'present'
  
  -- October 24, 2025 attendance (17 employees present)
  UNION SELECT '2025-10-24'::date, '00000001', 'present'
  UNION SELECT '2025-10-24'::date, '00000002', 'present'
  UNION SELECT '2025-10-24'::date, '00000003', 'present'
  UNION SELECT '2025-10-24'::date, '00000004', 'present'
  UNION SELECT '2025-10-24'::date, '00000005', 'present'
  UNION SELECT '2025-10-24'::date, '00000006', 'present'
  UNION SELECT '2025-10-24'::date, '00000007', 'present'
  UNION SELECT '2025-10-24'::date, '00000008', 'present'
  UNION SELECT '2025-10-24'::date, '00000009', 'present'
  UNION SELECT '2025-10-24'::date, '00000010', 'present'
  UNION SELECT '2025-10-24'::date, '00000012', 'present'
  UNION SELECT '2025-10-24'::date, '00000013', 'present'
  UNION SELECT '2025-10-24'::date, '00000014', 'present'
  UNION SELECT '2025-10-24'::date, '00000015', 'present'
  UNION SELECT '2025-10-24'::date, '00000017', 'present'
  UNION SELECT '2025-10-24'::date, '00000018', 'present'
  UNION SELECT '2025-10-24'::date, '00000019', 'present'
  UNION SELECT '2025-10-24'::date, '00000020', 'present'
  UNION SELECT '2025-10-24'::date, '00000021', 'present'
  UNION SELECT '2025-10-24'::date, '00000023', 'present'
  
  -- October 25, 2025 attendance (16 employees present)
  UNION SELECT '2025-10-25'::date, '00000001', 'present'
  UNION SELECT '2025-10-25'::date, '00000002', 'present'
  UNION SELECT '2025-10-25'::date, '00000003', 'present'
  UNION SELECT '2025-10-25'::date, '00000004', 'present'
  UNION SELECT '2025-10-25'::date, '00000005', 'present'
  UNION SELECT '2025-10-25'::date, '00000006', 'present'
  UNION SELECT '2025-10-25'::date, '00000007', 'present'
  UNION SELECT '2025-10-25'::date, '00000008', 'present'
  UNION SELECT '2025-10-25'::date, '00000009', 'present'
  UNION SELECT '2025-10-25'::date, '00000012', 'present'
  UNION SELECT '2025-10-25'::date, '00000013', 'present'
  UNION SELECT '2025-10-25'::date, '00000014', 'present'
  UNION SELECT '2025-10-25'::date, '00000015', 'present'
  UNION SELECT '2025-10-25'::date, '00000017', 'present'
  UNION SELECT '2025-10-25'::date, '00000018', 'present'
  UNION SELECT '2025-10-25'::date, '00000019', 'present'
  UNION SELECT '2025-10-25'::date, '00000020', 'present'
  UNION SELECT '2025-10-25'::date, '00000021', 'present'
  UNION SELECT '2025-10-25'::date, '00000023', 'present'
  
  -- October 27, 2025 attendance (15 employees present)  
  UNION SELECT '2025-10-27'::date, '00000001', 'present'
  UNION SELECT '2025-10-27'::date, '00000002', 'present'
  UNION SELECT '2025-10-27'::date, '00000003', 'present'
  UNION SELECT '2025-10-27'::date, '00000004', 'present'
  UNION SELECT '2025-10-27'::date, '00000006', 'present'
  UNION SELECT '2025-10-27'::date, '00000007', 'present'
  UNION SELECT '2025-10-27'::date, '00000008', 'present'
  UNION SELECT '2025-10-27'::date, '00000009', 'present'
  UNION SELECT '2025-10-27'::date, '00000010', 'present'
  UNION SELECT '2025-10-27'::date, '00000012', 'present'
  UNION SELECT '2025-10-27'::date, '00000013', 'present'
  UNION SELECT '2025-10-27'::date, '00000014', 'present'
  UNION SELECT '2025-10-27'::date, '00000015', 'present'
  UNION SELECT '2025-10-27'::date, '00000016', 'present'
  UNION SELECT '2025-10-27'::date, '00000017', 'present'
  UNION SELECT '2025-10-27'::date, '00000019', 'present'
  UNION SELECT '2025-10-27'::date, '00000020', 'present'
  UNION SELECT '2025-10-27'::date, '00000021', 'present'
  UNION SELECT '2025-10-27'::date, '00000023', 'present'
  
  -- October 28, 2025 attendance (14 employees present)
  UNION SELECT '2025-10-28'::date, '00000001', 'present'
  UNION SELECT '2025-10-28'::date, '00000002', 'present'
  UNION SELECT '2025-10-28'::date, '00000003', 'present'
  UNION SELECT '2025-10-28'::date, '00000004', 'present'
  UNION SELECT '2025-10-28'::date, '00000006', 'present'
  UNION SELECT '2025-10-28'::date, '00000007', 'present'
  UNION SELECT '2025-10-28'::date, '00000008', 'present'
  UNION SELECT '2025-10-28'::date, '00000009', 'present'
  UNION SELECT '2025-10-28'::date, '00000010', 'present'
  UNION SELECT '2025-10-28'::date, '00000012', 'present'
  UNION SELECT '2025-10-28'::date, '00000014', 'present'
  UNION SELECT '2025-10-28'::date, '00000015', 'present'
  UNION SELECT '2025-10-28'::date, '00000016', 'present'
  UNION SELECT '2025-10-28'::date, '00000019', 'present'
  UNION SELECT '2025-10-28'::date, '00000020', 'present'
  UNION SELECT '2025-10-28'::date, '00000021', 'present'
  UNION SELECT '2025-10-28'::date, '00000023', 'present'
  
  -- October 29, 2025 attendance (15 employees present)
  UNION SELECT '2025-10-29'::date, '00000001', 'present'
  UNION SELECT '2025-10-29'::date, '00000002', 'present'
  UNION SELECT '2025-10-29'::date, '00000003', 'present'
  UNION SELECT '2025-10-29'::date, '00000004', 'present'
  UNION SELECT '2025-10-29'::date, '00000005', 'present'
  UNION SELECT '2025-10-29'::date, '00000007', 'present'
  UNION SELECT '2025-10-29'::date, '00000008', 'present'
  UNION SELECT '2025-10-29'::date, '00000009', 'present'
  UNION SELECT '2025-10-29'::date, '00000010', 'present'
  UNION SELECT '2025-10-29'::date, '00000012', 'present'
  UNION SELECT '2025-10-29'::date, '00000013', 'present'
  UNION SELECT '2025-10-29'::date, '00000014', 'present'
  UNION SELECT '2025-10-29'::date, '00000015', 'present'
  UNION SELECT '2025-10-29'::date, '00000016', 'present'
  UNION SELECT '2025-10-29'::date, '00000017', 'present'
  UNION SELECT '2025-10-29'::date, '00000019', 'present'
  UNION SELECT '2025-10-29'::date, '00000020', 'present'
  UNION SELECT '2025-10-29'::date, '00000021', 'present'
  UNION SELECT '2025-10-29'::date, '00000023', 'present'
  
  -- October 30, 2025 attendance (17 employees present)
  UNION SELECT '2025-10-30'::date, '00000001', 'present'
  UNION SELECT '2025-10-30'::date, '00000002', 'present'
  UNION SELECT '2025-10-30'::date, '00000003', 'present'
  UNION SELECT '2025-10-30'::date, '00000004', 'present'
  UNION SELECT '2025-10-30'::date, '00000005', 'present'
  UNION SELECT '2025-10-30'::date, '00000006', 'present'
  UNION SELECT '2025-10-30'::date, '00000007', 'present'
  UNION SELECT '2025-10-30'::date, '00000008', 'present'
  UNION SELECT '2025-10-30'::date, '00000009', 'present'
  UNION SELECT '2025-10-30'::date, '00000010', 'present'
  UNION SELECT '2025-10-30'::date, '00000012', 'present'
  UNION SELECT '2025-10-30'::date, '00000013', 'present'
  UNION SELECT '2025-10-30'::date, '00000015', 'present'
  UNION SELECT '2025-10-30'::date, '00000016', 'present'
  UNION SELECT '2025-10-30'::date, '00000017', 'present'
  UNION SELECT '2025-10-30'::date, '00000019', 'present'
  UNION SELECT '2025-10-30'::date, '00000020', 'present'
  UNION SELECT '2025-10-30'::date, '00000021', 'present'
  UNION SELECT '2025-10-30'::date, '00000023', 'present'
  
  -- October 31, 2025 attendance (17 employees present)
  UNION SELECT '2025-10-31'::date, '00000001', 'present'
  UNION SELECT '2025-10-31'::date, '00000002', 'present'
  UNION SELECT '2025-10-31'::date, '00000004', 'present'
  UNION SELECT '2025-10-31'::date, '00000005', 'present'
  UNION SELECT '2025-10-31'::date, '00000006', 'present'
  UNION SELECT '2025-10-31'::date, '00000007', 'present'
  UNION SELECT '2025-10-31'::date, '00000008', 'present'
  UNION SELECT '2025-10-31'::date, '00000009', 'present'
  UNION SELECT '2025-10-31'::date, '00000010', 'present'
  UNION SELECT '2025-10-31'::date, '00000012', 'present'
  UNION SELECT '2025-10-31'::date, '00000013', 'present'
  UNION SELECT '2025-10-31'::date, '00000014', 'present'
  UNION SELECT '2025-10-31'::date, '00000015', 'present'
  UNION SELECT '2025-10-31'::date, '00000016', 'present'
  UNION SELECT '2025-10-31'::date, '00000017', 'present'
  UNION SELECT '2025-10-31'::date, '00000019', 'present'
  UNION SELECT '2025-10-31'::date, '00000020', 'present'
  UNION SELECT '2025-10-31'::date, '00000021', 'present'
  UNION SELECT '2025-10-31'::date, '00000023', 'present'
)
SELECT * FROM attendance_summary;

-- Now insert the attendance records into the main attendance table
INSERT INTO attendance (employee_id, attendance_date, status, marked_at, marked_by)
SELECT 
  e.id as employee_id,
  tal.attendance_date,
  tal.status,
  CURRENT_TIMESTAMP as marked_at,
  'ALOG_001_import' as marked_by
FROM temp_attendance_log tal
JOIN employees e ON e.card_no = tal.card_no
WHERE e.is_active = true
ON CONFLICT (employee_id, attendance_date) 
DO UPDATE SET 
  status = EXCLUDED.status,
  marked_at = EXCLUDED.marked_at,
  marked_by = EXCLUDED.marked_by;

-- Verify the import
SELECT 
  COUNT(*) as total_records,
  COUNT(DISTINCT employee_id) as unique_employees,
  COUNT(DISTINCT attendance_date) as unique_dates,
  MIN(attendance_date) as start_date,
  MAX(attendance_date) as end_date
FROM attendance 
WHERE marked_by = 'ALOG_001_import';

-- Show attendance summary by employee
SELECT 
  e.employee_name,
  e.card_no,
  COUNT(*) as days_present,
  MIN(a.attendance_date) as first_attendance,
  MAX(a.attendance_date) as last_attendance
FROM attendance a
JOIN employees e ON a.employee_id = e.id
WHERE a.marked_by = 'ALOG_001_import'
  AND a.status = 'present'
GROUP BY e.id, e.employee_name, e.card_no
ORDER BY e.card_no;